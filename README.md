# 虚假新闻检测Agent

基于规则和大模型的虚假新闻检测系统，使用提示词工程驱动检测流程。

## 功能特点

- 基于6大规则检测虚假新闻可能性
- 支持网络搜索验证功能，对时效性新闻进行多源交叉验证
- 支持通义千问/讯飞星火等国产大模型
- 知识截止日期感知能力，能正确处理模型知识范围外的新闻
- 语义级内容相似度比较，提高验证准确性
- 多关键词组合搜索，提高搜索成功率
- 提供网页交互界面，支持置信度指标展示


## 环境要求

- Python 3.8+
- 需要大模型API访问权限（通义千问/讯飞星火等）
- 可选：Google Custom Search API（用于网络搜索验证功能）

## 安装步骤

1. 克隆仓库：...
2. 安装依赖
```bash
pip install -r requirements.txt
```
3. 配置环境变量：
在项目根目录创建`.env`文件，添加以下内容：
```
# 大模型API配置（以通义千问-max为例）
LLM_API_URL=https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation
LLM_API_KEY=你的API_KEY
LLM_MODEL=qwen-max

# 网络搜索验证配置（可选）
ENABLE_WEB_SEARCH=false
GOOGLE_API_KEY=你的Google_API_KEY
GOOGLE_SEARCH_ENGINE_ID=你的搜索引擎ID

# 调试模式
DEBUG_MODE=false
```

## 使用方法

### 启动

```bash
python main.py --web --web-search
```

然后在浏览器访问 http://localhost:7860

### 自定义端口启动（如果默认端口被占用）

```bash
python main.py --web --port 7865
```

## 检测规则说明

系统基于以下6条规则进行检测：

1. **域名可信度检查**：新闻来自一个不知名或需要怀疑的域名URL。
2. **标题情绪化检查**：新闻标题中是否包含耸人听闻的引子、挑衅性或情绪化的语言、或夸张的声明。
3. **语法错误检查**：新闻标题是否包含错别字、语法错误、引号使用不当。
4. **常识合理性检查**：新闻是否潜在地不合理或与常识相矛盾，或更像八卦而不是事实报道。
5. **政治偏向性检查**：新闻是否偏向于特定的政治观点，旨在影响公众舆论而不是呈现客观信息。
6. **信息一致性检查**：是否存在其他在线资源包含任何不一致、矛盾或对立的内容。

## 网络搜索验证功能

为了更好地处理时效性新闻，系统增加了动态网络搜索验证功能：

1. **工作流程**：
   - 在完成6大规则基础分析后，对中高风险新闻触发网络验证
   - 从新闻中提取关键词并调用Google搜索API
   - 对搜索结果进行分析，验证内容一致性

2. **验证维度**：
   - 可信来源匹配：检查权威媒体报道情况
   - 内容细节一致性：对比关键数据一致性
   - 多源交叉验证：依赖多方独立信源而非单一报道
   - 语义级匹配：超越简单文本匹配，能理解相似表述

3. **风险评估调整**：
   - 调整后的风险评分比例更加平衡，避免网络验证结果过度影响最终评分
   - 分级风险调整：根据证据可靠性确定调整幅度
   - 高一致性验证最多调整15%风险度

4. **使用限制**：
   - 需要Google Custom Search API密钥
   - 有API调用次数限制
   - 仅适用于已有公开报道的新闻

## 知识截止日期处理机制

本系统特别针对大模型知识库截止日期问题进行了优化：

1. **知识截止日期感知**：
   - 自动识别发生在模型知识截止日期之后的事件
   - 在新闻分析中明确标示知识截止日期（默认为2023年9月）
   - 对超出知识范围的新闻规则标记为"无法验证"，而非错误地判断为"不符合"

2. **动态规则权重**：
   - 当某些规则被标记为"无法验证"时，自动调整其他规则的权重
   - 确保风险评估仅基于有效规则，不受知识截止问题影响

3. **强制网络验证**：
   - 对超出知识截止日期的新闻自动触发网络搜索验证
   - 即使风险评估为低风险，也会执行网络验证以获取最新信息

## 最近更新

- **多源搜索**: 使用多个关键词组合进行网络搜索，大幅提高搜索成功率
- **实体识别**: 增强了实体和数据点提取能力，提高匹配精度
- **置信度指标**: 在分析结果中增加置信度评估，帮助用户理解结果可靠性
- **语义匹配**: 在比较新闻与搜索结果时，增加了语义级匹配能力
- **跨语言支持**: 增强对中英文混合内容的处理能力

## 后续扩展方向

1. 多模态分析，支持图像真伪分析
2. 本地部署小型模型，减少API依赖和延迟
3. 专业领域垂直检测模型，如科技/医疗/财经等特定领域
4. 历史新闻数据库集成，建立更可靠的验证来源
